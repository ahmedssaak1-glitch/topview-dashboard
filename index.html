<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Top View — Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --accent:#1f78ff;
      --muted:#6b7280;
      --bg:#f6f7fb;
      --card:#ffffff;
      --radius:12px;
      --glass: rgba(255,255,255,0.85);
    }
    *{box-sizing:border-box}
    body{font-family:Inter,system-ui,Arial; margin:0; background:var(--bg); color:#0f172a}
    a{color:inherit}
    /* LOGIN HERO */
    .hero{min-height:100vh; display:flex; align-items:center; justify-content:center; background-image: url('https://images.unsplash.com/photo-1512453979798-5ea266f8880c?auto=format&fit=crop&w=1600&q=80'); background-size:cover; background-position:center; position:relative;}
    .overlay{position:absolute; inset:0; background:linear-gradient(180deg, rgba(0,0,0,0.45), rgba(0,0,0,0.45));}
    .login-card{position:relative; z-index:2; width:100%; max-width:420px; padding:36px; border-radius:14px; background:var(--glass); box-shadow:0 10px 30px rgba(2,6,23,0.12);}
    .logo{font-weight:700; color:var(--accent); font-size:20px; margin-bottom:6px}
    .lead{color:#0b1220; font-weight:600; margin-bottom:8px}
    .sub{color:var(--muted); font-size:13px; margin-bottom:18px}
    input{width:100%; padding:12px 14px; border-radius:10px; border:1px solid #e6e9ef; margin:10px 0; font-size:15px}
    .row{display:flex; gap:8px}
    .btn{display:inline-block; padding:11px 14px; border-radius:10px; border:0; cursor:pointer}
    .btn-primary{background:var(--accent); color:white; font-weight:700}
    .btn-ghost{background:transparent; border:1px solid rgba(15,23,42,0.06)}
    .small{font-size:13px; color:var(--muted); margin-top:10px; text-align:center}

    /* APP LAYOUT */
    .app{display:flex; min-height:100vh}
    .sidebar{width:260px; background:linear-gradient(180deg,#ffffff,#fbfcff); border-right:1px solid #eef2f7; padding:20px; display:flex; flex-direction:column; gap:12px;}
    .sidebar .brand{font-weight:800; color:var(--accent); font-size:18px; margin-bottom:6px}
    .nav{display:flex; flex-direction:column; gap:6px; margin-top:8px}
    .nav button{background:transparent; border:0; text-align:left; padding:10px; border-radius:8px; cursor:pointer; font-weight:600}
    .nav button.active{background:#f1f6ff; color:var(--accent)}
    .user-box{margin-top:auto; padding-top:10px; border-top:1px solid #f1f3f7}
    .main{flex:1; padding:24px}
    .topbar{display:flex; justify-content:space-between; align-items:center; margin-bottom:16px}
    .stats{display:grid; grid-template-columns:repeat(3,1fr); gap:16px; margin-bottom:18px}
    .card{background:var(--card); padding:16px; border-radius:12px; box-shadow:0 6px 20px rgba(2,6,23,0.04)}
    table{width:100%; border-collapse:collapse; font-size:14px}
    th,td{padding:12px 10px; border-bottom:1px solid #f3f6fa; text-align:left}
    th{background:#fafbff; color:var(--muted); font-weight:700; font-size:13px}
    .actions{display:flex; gap:8px}
    .chip{display:inline-block; padding:6px 10px; border-radius:999px; background:#eef6ff; color:var(--accent); font-weight:700; font-size:13px}
    /* responsive */
    @media (max-width:900px){.sidebar{display:none}.stats{grid-template-columns:repeat(2,1fr)}.topbar .right{display:none}}
    @media (max-width:600px){.stats{grid-template-columns:1fr}.login-card{padding:20px; border-radius:10px}}
  </style>
</head>
<body>
  <div id="root"></div>

  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-analytics.js";
    import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
    import { getFirestore, collection, getDocs, addDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyCEpRw7F829fqzPZAphqJ2wOe3xUDJWLtw",
      authDomain: "topview-system.firebaseapp.com",
      projectId: "topview-system",
      storageBucket: "topview-system.firebasestorage.app",
      messagingSenderId: "1073945877413",
      appId: "1:1073945877413:web:d516e451e543f7a9db664c",
      measurementId: "G-EPVZGH6Y2G"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const auth = getAuth(app);
    const db = getFirestore(app);

    const root = document.getElementById('root');

    // ---- UI helper ----
    function el(tag,attrs={},...kids){ const n=document.createElement(tag); for(const k in attrs){ if(k==='class') n.className=attrs[k]; else if(k==='html') n.innerHTML=attrs[k]; else n.setAttribute(k,attrs[k]); } kids.forEach(c=>{ if(typeof c==='string') n.appendChild(document.createTextNode(c)); else if(c) n.appendChild(c);}); return n; }

    // ---- LOGIN UI ----
    function showLogin(){
      root.innerHTML='';
      const hero = el('div',{class:'hero'});
      hero.appendChild(el('div',{class:'overlay'}));
      const card = el('div',{class:'login-card'});
      card.appendChild(el('div',{class:'logo'},'Top View'));
      card.appendChild(el('div',{class:'lead'},'Welcome back'));
      card.appendChild(el('div',{class:'sub'},'Top View — Real Estate & Fit-out Solutions'));
      const emailInput = el('input',{type:'email',placeholder:'Email'});
      const passInput = el('input',{type:'password',placeholder:'Password'});
      const loginBtn = el('button',{class:'btn btn-primary'},'Login');
      loginBtn.onclick = async ()=>{
        try{
          await signInWithEmailAndPassword(auth, emailInput.value.trim(), passInput.value);
        } catch(err){ alert('Login failed: '+err.message); }
      };
      card.appendChild(emailInput); card.appendChild(passInput); card.appendChild(loginBtn);
      hero.appendChild(card); root.appendChild(hero);
    }

    // ---- Auth state ----
    onAuthStateChanged(auth, user=>{
      if(user){
        renderApp(user);
      } else {
        showLogin();
      }
    });

    // ---- APP UI ----
    async function renderApp(user){
      root.innerHTML='';
      const appDiv = el('div',{class:'app'});
      const sidebar = el('div',{class:'sidebar'});
      sidebar.appendChild(el('div',{class:'brand'}, 'Top View'));
      const nav = el('div',{class:'nav'});
      const pages = ['Dashboard','Employees','Projects','Finance','Attendance','Settings'];
      let active = 'Dashboard';
      pages.forEach(p=>{
        const btn = el('button',{class: p===active?'active':''},p);
        btn.onclick=()=>{ active=p; renderMain(); };
        nav.appendChild(btn);
      });
      sidebar.appendChild(nav);

      const userBox = el('div',{class:'user-box'});
      userBox.appendChild(el('div',{style:'font-weight:700'}, user.email));
      const logoutBtn = el('button',{class:'btn'},'Logout
